---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/",
  out.width = "100%"
)
```

# cria_classes

üë§ Autor: Jos√© M√°rio Nunes da Silva

e-mail: zemariu@usp.br

## A Fun√ß√£o `cria_classe`

A fun√ß√£o `cria_classes` automatiza o processo de cria√ß√£o de classes para vari√°veis num√©ricas utilizadas em mapas tem√°ticos, permitindo diferentes m√©todos de classifica√ß√£o e tratando valores iguais a zero como uma classe independente. Isso torna o
procedimento mais transparente, reprodut√≠vel e adequado para an√°lises epidemiol√≥gicas, especialmente quando h√° √°reas sem ocorr√™ncia do evento analisado.

Este c√≥digo faz parte do **curso Epidemiologia Descritiva Aplicada √† Tuberculose**, mas pode ser usado amplamente em an√°lises epidemiol√≥gicas e espaciais.

# Instala√ß√£o

Como esta fun√ß√£o n√£o √© (ainda) um pacote CRAN, instale diretamente do GitHub:
```{r eval=FALSE}
# install.packages("devtools")
devtools::install_github("zemariu/cria_classes")
```

## O que a fun√ß√£o faz?

* Gera classes para vari√°veis num√©ricas com diversos estilos:

    -  `"quantile"` ‚Äî intervalos por quantis

    -  `"equal"` ‚Äî intervalos de amplitude igual

    -  `"sd"` ‚Äî m√©dia ¬± desvio-padr√£o

    -  `"pretty"` ‚Äî intervalos arredondados

    -  `"fixed"` ‚Äî intervalos definidos manualmente pelo usu√°rio

* Cria automaticamente:

    -  uma classe exclusiva para valores **zero**,

    -  uma coluna de classes (`classe`),

    -  uma coluna com r√≥tulos finalizados (`classe_label`) contendo o n√∫mero de observa√ß√µes por intervalo.

* Suporta separadores decimais v√≠rgula ou ponto.

## Depend√™ncias

A fun√ß√£o utiliza:

* `dplyr`

* `classInt`

* `rlang`

Esses pacotes s√£o carregados automaticamente quando a fun√ß√£o √© chamada (instalando caso necess√°rio).

# Como funciona

* Ap√≥s carregar o script com `source()`, a fun√ß√£o passa a ficar dispon√≠vel no ambiente do R.

* No **RStudio**, voc√™ pode confirmar sua presen√ßa observando o painel **Environment** (canto superior direito), onde o nome `cria_classes` aparecer√° listado.

## Principais argumentos da fun√ß√£o 

* **`dados`**: Objeto (data.frame ou tibble) que cont√©m a vari√°vel num√©rica a ser classificada. √â o *dataset* original ao qual as novas colunas de classes ser√£o adicionadas.

* **`var`**: Nome (string) da vari√°vel num√©rica dentro de `dados` que ser√° usada para gerar os intervalos de classe. Exemplo: `"INCID_2024"`.

* **`n_classes`**: N√∫mero de classes a serem criadas (default: **3**). √â ignorado se `style = "fixed"`.

* **`style`**: Define o m√©todo de classifica√ß√£o utilizado para gerar os intervalos. Op√ß√µes aceitas: `"quantile"`, `"equal"`, `"sd"`, `"pretty"`, `"fixed"` e `breaks_fixed`

* **`breaks_fixed`**: Usado somente quando `style = "fixed"`.
Vetor num√©rico com os limites dos intervalos. Exemplo:

```{r eval=FALSE}
breaks_fixed = c(0, 10, 50, 100)
```

* **`nome_classe`**: Nome da nova coluna de sa√≠da contendo as classes (fatores), o default: `"classe"`.

* **`sep_decimal`**: Define o separador decimal usado nos r√≥tulos produzidos. Op√ß√µes:* 

    -   `","` (default, √∫til para textos e mapas em portugu√™s)
    -   `"."` (padr√£o internacional)

* **Colunas criadas automaticamente**

   -  A fun√ß√£o sempre cria: **`<nome_classe>`**
   -  Coluna contendo os intervalos como fatores: **`<nome_classe>_label`**

Coluna com r√≥tulos finais no formato:

```{eval=FALSE}
a ‚Äì b [n]
```

onde **n** √© o n√∫mero de observa√ß√µes em cada classe.

## Exemplo de uso
```{eval=FALSE}
# Exemplo ilustrativo

# Carregando a fun√ß√£o depois de baixar
source("cria_classes.R")

# Data frame
df <- data.frame(incid = c(0, 0, 1.5, 3.2, 7.8, 10.1, 14.2))

# Usando a fun√ß√£o
resultado <- cria_classes(
dados = df,
var   = "incid",
n_classes = 3,
style = "quantile",
nome_classe = "classe_incid"
)

# Visualizando resultado
resultado
```

## Sa√≠da esperada:

A fun√ß√£o retorna o objeto com duas novas colunas:

* classe_incid

* classe_incid_label

## Licen√ßa

GPL-3 (recomendado para pacotes acad√™micos; adapte se necess√°rio)

## Citation

Se utilizar esta fun√ß√£o em materiais acad√™micos, cite:

da Silva, J. M. N. (2025). `cria_classes()`: fun√ß√£o para gera√ß√£o de intervalos de classes em an√°lises epidemiol√≥gicas e mapas tem√°ticos.
